{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/omara/OneDrive/Desktop/AmsirarTrip%20Enhanced/i18n/request.ts"],"sourcesContent":["import { getRequestConfig } from \"next-intl/server\";\nimport { routing } from \"./routing\";\n\nexport default getRequestConfig(async ({ requestLocale }) => {\n  // Get locale from the request using the new API\n  let locale = await requestLocale;\n\n  // Validate that the incoming `locale` parameter is valid\n  if (\n    !locale ||\n    !routing.locales.includes(locale as \"en\" | \"fr\" | \"de\" | \"es\")\n  ) {\n    locale = routing.defaultLocale;\n  }\n\n  return {\n    locale,\n    messages: (await import(`../public/locales/${locale}/common.json`)).default,\n  };\n});\n"],"names":[],"mappings":";;;;AAAA;AACA;;;uCAEe,IAAA,8QAAgB,EAAC,OAAO,EAAE,aAAa,EAAE;IACtD,gDAAgD;IAChD,IAAI,SAAS,MAAM;IAEnB,yDAAyD;IACzD,IACE,CAAC,UACD,CAAC,0HAAO,CAAC,OAAO,CAAC,QAAQ,CAAC,SAC1B;QACA,SAAS,0HAAO,CAAC,aAAa;IAChC;IAEA,OAAO;QACL;QACA,UAAU,CAAC;;;;;;;;;;;;;;;;;kBAAa,CAAC,kBAAkB,EAAE,OAAO,YAAY,CAAC,CAAC,EAAE,OAAO;IAC7E;AACF"}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/omara/OneDrive/Desktop/AmsirarTrip%20Enhanced/i18n/routing.ts"],"sourcesContent":["import { defineRouting } from \"next-intl/routing\";\nimport { createNavigation } from \"next-intl/navigation\";\n\nexport const routing = defineRouting({\n  // A list of all locales that are supported\n  locales: [\"en\", \"fr\", \"de\", \"es\"],\n\n  // Used when no locale matches\n  defaultLocale: \"en\",\n\n  // The `pathnames` object can be used to define\n  // locale-specific pathnames\n  localePrefix: \"as-needed\",\n});\n\n// Lightweight wrappers around Next.js' navigation APIs\n// that will consider the routing configuration\nexport const { Link, redirect, usePathname, useRouter } =\n  createNavigation(routing);\n"],"names":[],"mappings":";;;;;;;;;;;;AAAA;AACA;;;AAEO,MAAM,UAAU,IAAA,mPAAa,EAAC;IACnC,2CAA2C;IAC3C,SAAS;QAAC;QAAM;QAAM;QAAM;KAAK;IAEjC,8BAA8B;IAC9B,eAAe;IAEf,+CAA+C;IAC/C,4BAA4B;IAC5B,cAAc;AAChB;AAIO,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,WAAW,EAAE,SAAS,EAAE,GACrD,IAAA,kRAAgB,EAAC"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/omara/OneDrive/Desktop/AmsirarTrip%20Enhanced/proxy.ts"],"sourcesContent":["import createMiddleware from \"next-intl/middleware\";\nimport { routing } from \"./i18n/routing\";\nimport { NextRequest, NextResponse } from \"next/server\";\n\nconst intlMiddleware = createMiddleware(routing);\n\n/**\n * API route security middleware\n * Applies additional security checks for API routes\n */\nfunction apiSecurityMiddleware(request: NextRequest): NextResponse | null {\n  const { pathname } = request.nextUrl;\n\n  // Check if this is an API route\n  if (!pathname.startsWith(\"/api/\")) {\n    return null;\n  }\n\n  // Only allow POST for form submissions\n  if (![\"POST\", \"GET\", \"OPTIONS\"].includes(request.method)) {\n    return NextResponse.json(\n      { ok: false, error: \"Method not allowed\" },\n      { status: 405 }\n    );\n  }\n\n  // Handle OPTIONS for CORS preflight\n  if (request.method === \"OPTIONS\") {\n    return new NextResponse(null, {\n      status: 204,\n      headers: {\n        \"Access-Control-Allow-Origin\": request.headers.get(\"origin\") || \"*\",\n        \"Access-Control-Allow-Methods\": \"POST, GET, OPTIONS\",\n        \"Access-Control-Allow-Headers\": \"Content-Type\",\n        \"Access-Control-Max-Age\": \"86400\",\n      },\n    });\n  }\n\n  // CSRF Protection: Check for proper headers on state-changing requests\n  if (request.method === \"POST\") {\n    const origin = request.headers.get(\"origin\");\n    const referer = request.headers.get(\"referer\");\n    const host = request.headers.get(\"host\");\n\n    // For POST requests, verify they come from our domain\n    if (origin && host) {\n      try {\n        const originHost = new URL(origin).host;\n        if (originHost !== host) {\n          console.warn(\n            `[SECURITY] CSRF attempt blocked - Origin: ${origin}, Host: ${host}`\n          );\n          return NextResponse.json(\n            { ok: false, error: \"Invalid request origin\" },\n            { status: 403 }\n          );\n        }\n      } catch (e) {\n        console.error(\"Error parsing origin:\", e);\n      }\n    } else if (referer && host) {\n      try {\n        const refererHost = new URL(referer).host;\n        if (refererHost !== host) {\n          console.warn(\n            `[SECURITY] CSRF attempt blocked - Referer: ${referer}, Host: ${host}`\n          );\n          return NextResponse.json(\n            { ok: false, error: \"Invalid request source\" },\n            { status: 403 }\n          );\n        }\n      } catch (e) {\n        console.error(\"Error parsing referer:\", e);\n      }\n    }\n  }\n\n  return null;\n}\n\n/**\n * Bot protection middleware\n * Blocks known bad bots and scrapers\n */\nfunction botProtectionMiddleware(request: NextRequest): NextResponse | null {\n  const userAgent = request.headers.get(\"user-agent\")?.toLowerCase() || \"\";\n\n  // List of bad bots to block\n  const badBots = [\n    \"httrack\",\n    \"semrushbot\",\n    \"ahrefsbot\",\n    \"mj12bot\",\n    \"dotbot\",\n    \"petalbot\",\n    \"seznambot\",\n    \"python-requests\",\n    \"scrapy\",\n    \"libwww-perl\",\n    \"wget\",\n    \"curl\",\n  ];\n\n  // Check if User-Agent contains any bad bot string\n  if (badBots.some((bot) => userAgent.includes(bot))) {\n    console.warn(`[SECURITY] Bad bot blocked: ${userAgent}`);\n    return new NextResponse(\"Forbidden\", { status: 403 });\n  }\n\n  return null;\n}\n\nexport default function proxy(request: NextRequest) {\n  // 1. Bot Protection\n  const botResponse = botProtectionMiddleware(request);\n  if (botResponse) return botResponse;\n\n  // 2. API Security\n  const apiResponse = apiSecurityMiddleware(request);\n  if (apiResponse) return apiResponse;\n\n  // 3. Internationalization\n  const response = intlMiddleware(request);\n\n  // 4. Security Headers (CSP, etc.)\n  // Ensure CSP is applied even if next.config fails\n  if (!response.headers.has(\"Content-Security-Policy\")) {\n    response.headers.set(\n      \"Content-Security-Policy\",\n      `default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/ https://kit.fontawesome.com; style-src 'self' 'unsafe-inline' https://kit.fontawesome.com; img-src 'self' data: blob: https:; font-src 'self' data: https://kit.fontawesome.com https://ka-f.fontawesome.com; connect-src 'self' https://www.google-analytics.com https://www.googletagmanager.com https://www.google.com/recaptcha/ https://www.gstatic.com/recaptcha/ https://ka-f.fontawesome.com; frame-src 'self' https://www.google.com https://www.google.com/recaptcha/ https://recaptcha.google.com/recaptcha/; object-src 'none'; base-uri 'self'; form-action 'self'; frame-ancestors 'none';${\n        process.env.NODE_ENV === \"production\"\n          ? \" upgrade-insecure-requests;\"\n          : \"\"\n      } block-all-mixed-content;`\n    );\n  }\n\n  // Security headers fallback (if next.config.ts fails to apply them)\n  const securityHeaders: [string, string][] = [\n    [\"X-Content-Type-Options\", \"nosniff\"],\n    [\"X-Frame-Options\", \"DENY\"],\n    [\"Referrer-Policy\", \"strict-origin-when-cross-origin\"],\n    [\"X-XSS-Protection\", \"1; mode=block\"],\n  ];\n\n  securityHeaders.forEach(([key, value]) => {\n    if (!response.headers.has(key)) {\n      response.headers.set(key, value);\n    }\n  });\n\n  return response;\n}\n\nexport const config = {\n  // Match all pathnames including API routes\n  matcher: [\"/((?!_next|_vercel|.*\\\\..*).*)\"],\n};\n"],"names":[],"mappings":";;;;;;AAAA;AACA;AACA;;;;AAEA,MAAM,iBAAiB,IAAA,iMAAgB,EAAC,0HAAO;AAE/C;;;CAGC,GACD,SAAS,sBAAsB,OAAoB;IACjD,MAAM,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;IAEpC,gCAAgC;IAChC,IAAI,CAAC,SAAS,UAAU,CAAC,UAAU;QACjC,OAAO;IACT;IAEA,uCAAuC;IACvC,IAAI,CAAC;QAAC;QAAQ;QAAO;KAAU,CAAC,QAAQ,CAAC,QAAQ,MAAM,GAAG;QACxD,OAAO,8IAAY,CAAC,IAAI,CACtB;YAAE,IAAI;YAAO,OAAO;QAAqB,GACzC;YAAE,QAAQ;QAAI;IAElB;IAEA,oCAAoC;IACpC,IAAI,QAAQ,MAAM,KAAK,WAAW;QAChC,OAAO,IAAI,8IAAY,CAAC,MAAM;YAC5B,QAAQ;YACR,SAAS;gBACP,+BAA+B,QAAQ,OAAO,CAAC,GAAG,CAAC,aAAa;gBAChE,gCAAgC;gBAChC,gCAAgC;gBAChC,0BAA0B;YAC5B;QACF;IACF;IAEA,uEAAuE;IACvE,IAAI,QAAQ,MAAM,KAAK,QAAQ;QAC7B,MAAM,SAAS,QAAQ,OAAO,CAAC,GAAG,CAAC;QACnC,MAAM,UAAU,QAAQ,OAAO,CAAC,GAAG,CAAC;QACpC,MAAM,OAAO,QAAQ,OAAO,CAAC,GAAG,CAAC;QAEjC,sDAAsD;QACtD,IAAI,UAAU,MAAM;YAClB,IAAI;gBACF,MAAM,aAAa,IAAI,IAAI,QAAQ,IAAI;gBACvC,IAAI,eAAe,MAAM;oBACvB,QAAQ,IAAI,CACV,CAAC,0CAA0C,EAAE,OAAO,QAAQ,EAAE,MAAM;oBAEtE,OAAO,8IAAY,CAAC,IAAI,CACtB;wBAAE,IAAI;wBAAO,OAAO;oBAAyB,GAC7C;wBAAE,QAAQ;oBAAI;gBAElB;YACF,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,yBAAyB;YACzC;QACF,OAAO,IAAI,WAAW,MAAM;YAC1B,IAAI;gBACF,MAAM,cAAc,IAAI,IAAI,SAAS,IAAI;gBACzC,IAAI,gBAAgB,MAAM;oBACxB,QAAQ,IAAI,CACV,CAAC,2CAA2C,EAAE,QAAQ,QAAQ,EAAE,MAAM;oBAExE,OAAO,8IAAY,CAAC,IAAI,CACtB;wBAAE,IAAI;wBAAO,OAAO;oBAAyB,GAC7C;wBAAE,QAAQ;oBAAI;gBAElB;YACF,EAAE,OAAO,GAAG;gBACV,QAAQ,KAAK,CAAC,0BAA0B;YAC1C;QACF;IACF;IAEA,OAAO;AACT;AAEA;;;CAGC,GACD,SAAS,wBAAwB,OAAoB;IACnD,MAAM,YAAY,QAAQ,OAAO,CAAC,GAAG,CAAC,eAAe,iBAAiB;IAEtE,4BAA4B;IAC5B,MAAM,UAAU;QACd;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACD;IAED,kDAAkD;IAClD,IAAI,QAAQ,IAAI,CAAC,CAAC,MAAQ,UAAU,QAAQ,CAAC,OAAO;QAClD,QAAQ,IAAI,CAAC,CAAC,4BAA4B,EAAE,WAAW;QACvD,OAAO,IAAI,8IAAY,CAAC,aAAa;YAAE,QAAQ;QAAI;IACrD;IAEA,OAAO;AACT;AAEe,SAAS,MAAM,OAAoB;IAChD,oBAAoB;IACpB,MAAM,cAAc,wBAAwB;IAC5C,IAAI,aAAa,OAAO;IAExB,kBAAkB;IAClB,MAAM,cAAc,sBAAsB;IAC1C,IAAI,aAAa,OAAO;IAExB,0BAA0B;IAC1B,MAAM,WAAW,eAAe;IAEhC,kCAAkC;IAClC,kDAAkD;IAClD,IAAI,CAAC,SAAS,OAAO,CAAC,GAAG,CAAC,4BAA4B;QACpD,SAAS,OAAO,CAAC,GAAG,CAClB,2BACA,CAAC,itBAAitB,EAChtB,sCACI,0BACA,GACL,yBAAyB,CAAC;IAE/B;IAEA,oEAAoE;IACpE,MAAM,kBAAsC;QAC1C;YAAC;YAA0B;SAAU;QACrC;YAAC;YAAmB;SAAO;QAC3B;YAAC;YAAmB;SAAkC;QACtD;YAAC;YAAoB;SAAgB;KACtC;IAED,gBAAgB,OAAO,CAAC,CAAC,CAAC,KAAK,MAAM;QACnC,IAAI,CAAC,SAAS,OAAO,CAAC,GAAG,CAAC,MAAM;YAC9B,SAAS,OAAO,CAAC,GAAG,CAAC,KAAK;QAC5B;IACF;IAEA,OAAO;AACT;AAEO,MAAM,SAAS;IACpB,2CAA2C;IAC3C,SAAS;QAAC;KAAiC;AAC7C"}}]
}